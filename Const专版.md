## const的应用(共享数据保护的一种方式）

- const 是 constant 的缩写，本意是不变的，不易改变的意思。在 C++ 中是用来修饰内置类型变量，自定义对象，成员函数，返回值，函数参数。

- C++ const 允许指定一个语义约束，编译器会强制实施这个约束，允许程序员告诉编译器某值是保持不变的。如果在编程中确实有某个值保持不变，就应该明确使用const，获得编译器的帮助。

- const修饰的数据类型是指常类型，常类型的变量或对象的值不能被更新。即const限定一个变量不允许被改变，产生静态作用。使用const在一定程度上可以提高程序的安全性和可靠性。

### 1.**常数据成员变量**

常数据成员变量允许在构造函数中初始化，但不能在函数体内初始化，只能在初始化列表中初始化。

例如: 一个点类point中定义的一个常数据成员变量Mysize（int const Mysize；），初始化如下

point（xx=0；yy=0；size=sizeof(point))  : Mysize(size)  {......}  

有两种类型：（假设A为类名）

（1）const int a;

  对象的成员。

 初始化语句为：A::A(int i):a(i){};

（2）static const int b;

  类的成员。

  初始化语句为：const int A::b=10;

### 2.**常成员函数**

#### 2.1 声明：<类型标识符>函数名(形参列表)const;

#### 2.2说明：

   1）const是函数类型的一部分，在实现部分也要带上该关键字；

   2）const关键字可以用于对重载函数的区分；

   3）常成员函数不能修改类的成员变量，也不可以调用类中没有用const修饰的成员函数，只能调用常成员函数，但是可以被其他成员函数调用；

   4）特别地：常对象只能访问类中const成员函数（除了系统自动调用的隐含构造函数以及析构函数）

### 3.**常引用**：被引用的对象不能被更新。如果想要使用类的私有成员，又想保证私有成员值的安全性（即私有成员的数值不被改变）的时候，可以使用常引用。

const 类型标识符 &引用名;

如Point（int const &x，int  &y）函数中，x是常引用，函数Point不能修改x的值。

### 4.**常对象**:用const修饰的对象。

const 类名 对象名；

常对象只能调用常成员函数，必须进行初始化。

### 5.**临时变量不能作为非const的引用参数**

## const的作用 

**const关键字可以有以下n个作用**

 

 （1）欲阻止一个变量被改变，可以使用const关键字。在定义该const变量时，通常需要对它进行初始化，因为以后就没有机会再去改变它了；

 

（2）对指针来说，可以指定指针本身为const，也可以指定指针所指的数据为const，或二者同时指定为const；

 

（3）在一个函数声明中，const可以修饰形参，表明它是一个输入参数，在函数内部不能改变其值；

 

（4）对于类的成员函数，若指定其为const类型，则表明其是一个常函数，不能修改类的成员变量；

 

（5）对于类的成员函数，有时候必须指定其返回值为const类型，以使得其返回值不为“左值”。例如：

 

const classA operator*(const classA& a1,const classA& a2);

 

　　operator*的返回结果必须是一个const对象。如果不是，这样的变态代码也不会编译出错：

 

classA a, b, c;

 

(a * b) = c; 	// 对a*b的结果赋值

 

　　操作(a * b) = c显然不符合编程者的初衷，也没有任何意义。

 

notes：①如果不想让编译器察觉到对 const 的操作，可以在 const 前面加上 volatile 关键字。Volatile 关键字跟 const 对应相反，是易变的，容易改变的意思。所以不会被编译器优化，编译器也就不会改变对 a 变量的操作。

②当有个成员函数想修改对象中的某一个成员时，这时我们可以使用 mutable 关键字修饰这个成员，mutable 的意思也是易变的，容易改变的意思，被 mutable 关键字修饰的成员可以处于不断变化中。以作业“ [const应用，改错后提交](http://studybar.cau.edu.cn/mod/assignment/view.php?id=39005) ”为例，对于int getMysize() const { TimesofGetMysize++; return Mysize;}，可以将“int TimesofGetMysize;”改成“mutable int TimesofGetMysize;”。